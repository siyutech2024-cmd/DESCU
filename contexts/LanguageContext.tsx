
import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';
import { Language } from '../types';

interface LanguageContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
  formatPrice: (price: number) => string;
}

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

const translations: Record<Language, Record<string, string>> = {
  zh: {
    'app.name': 'DESCU',
    'nav.search': 'æœç´¢å®è´ã€è½¦è¾†ã€æˆ¿äº§...',
    'nav.sell': 'å–é—²ç½®',
    'nav.home': 'é¦–é¡µ',
    'nav.cart': 'è´­ç‰©è½¦',
    'nav.favorites': 'æˆ‘çš„æ”¶è—',
    'nav.profile': 'æˆ‘çš„',
    'nav.login': 'ç™»å½•',
    'nav.chat': 'æ¶ˆæ¯',
    'nav.notifications': 'æé†’',
    'login.required': 'éœ€è¦ç™»å½•',
    'login.prompt': 'è¯·ç™»å½•ä»¥ç»§ç»­æ“ä½œ',
    'login.google': 'ä½¿ç”¨ Google ç™»å½•',
    'login.terms': 'ç»§ç»­å³è¡¨ç¤ºåŒæ„æœåŠ¡æ¡æ¬¾',
    'hero.title': 'æœ¬åœ°ä¹°å–ï¼Œæ–¹ä¾¿å¿«æ·',
    'hero.subtitle': 'æ‚¨èº«è¾¹çš„AIæ™ºèƒ½äºŒæ‰‹å¹³å°',
    'hero.cta': 'ç«‹å³æ¢ç´¢',
    'list.header': 'ä¸ºæ‚¨æ¨è',
    'list.search_results': 'æœç´¢ç»“æœ',
    'list.items_count': 'ä»¶å•†å“',
    'list.loading_loc': 'æ­£åœ¨å®šä½...',
    'list.loc_denied': 'è¯·å¼€å¯å®šä½',
    'list.loc_success': 'é™„è¿‘',
    'list.empty': 'æš‚æ— å•†å“ï¼Œå¿«æ¥å‘å¸ƒç¬¬ä¸€ä¸ªå§ï¼',
    'list.no_results': 'æ²¡æœ‰æ‰¾åˆ°ç›¸å…³å•†å“',
    'list.view_all': 'æŸ¥çœ‹æ‰€æœ‰å•†å“',
    'list.load_more': 'åŠ è½½æ›´å¤š',
    'list.loading_more': 'åŠ è½½ä¸­...',
    'card.nearby': 'é™„è¿‘',
    'chat.ask_price': 'è®®ä»·',
    'chat.offer_title': 'æå‡ºè®®ä»·',
    'chat.current_price': 'å½“å‰ä»·æ ¼',
    'chat.your_offer': 'æ‚¨çš„å‡ºä»·',
    'chat.send_offer': 'å‘é€è®®ä»·',
    'chat.cancel': 'å–æ¶ˆ',
    'card.add_cart': 'æƒ³è¦',
    'card.in_cart': 'å·²æ·»åŠ ',
    'card.promoted': 'æ¨å¹¿',
    'modal.title': 'å‘å¸ƒé—²ç½®',
    'modal.upload_text': 'ç‚¹å‡»ä¸Šä¼ ç…§ç‰‡',
    'modal.upload_hint': 'AIå°†è‡ªåŠ¨è¯†åˆ«å¹¶å¡«å†™ä¿¡æ¯',
    'modal.change_img': 'æ›´æ”¹å›¾ç‰‡',
    'modal.analyzing': 'AI æ­£åœ¨åˆ†æå›¾ç‰‡ç”Ÿæˆæè¿°...',
    'modal.analyzed': 'AI å·²ä¸ºæ‚¨è‡ªåŠ¨å¡«å……ä¿¡æ¯',
    'modal.label.title': 'æ ‡é¢˜',
    'modal.ph.title': 'ä¾‹å¦‚ï¼š95æˆæ–° iPhone 14',
    'modal.label.price': 'ä»·æ ¼',
    'modal.label.category': 'åˆ†ç±»',
    'modal.label.delivery': 'äº¤æ˜“æ–¹å¼',
    'modal.label.desc': 'è¯¦ç»†æè¿°',
    'modal.ph.desc': 'æè¿°ä¸€ä¸‹ç‰©å“çš„æ–°æ—§ç¨‹åº¦ã€å…¥æ‰‹æ¸ é“ç­‰...',
    'modal.loc.loading': 'å®šä½ä¸­...',
    'modal.loc.success': 'ä½ç½®å·²é”å®š',
    'modal.submit': 'ç«‹å³å‘å¸ƒ',
    'modal.submit.analyzing': 'åˆ†æä¸­...',
    'modal.policy_hint': 'å‘å¸ƒå³è¡¨ç¤ºæ‚¨åŒæ„æˆ‘ä»¬çš„å†…å®¹æ”¿ç­–ï¼Œä¸¥ç¦å‘å¸ƒä»‡æ¨è¨€è®ºæˆ–è™šå‡æ”¿æ²»ä¿¡æ¯ã€‚',
    'modal.ai_error': 'AIåˆ†æå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–ç¨åé‡è¯•',
    'cart.title': 'è´­ç‰©è½¦',
    'cart.empty': 'è´­ç‰©è½¦ç©ºç©ºå¦‚ä¹Ÿ',
    'cart.go_shop': 'å»é€›é€›',
    'cart.total': 'åˆè®¡',
    'cart.checkout': 'ç«‹å³ç»“ç®—',
    'cart.processing': 'å¤„ç†ä¸­...',
    'cart.success': 'ä¸‹å•æˆåŠŸï¼',
    'cat.all': 'å…¨éƒ¨',
    'cat.electronics': 'æ•°ç ',
    'cat.furniture': 'å®¶å…·',
    'cat.clothing': 'æœé¥°',
    'cat.books': 'å›¾ä¹¦',
    'cat.sports': 'è¿åŠ¨',
    'cat.vehicles': 'è½¦è¾†',
    'cat.real_estate': 'æˆ¿äº§',
    'cat.services': 'æœåŠ¡',
    'cat.other': 'å…¶ä»–',
    // Subcategories - Electronics
    'subcat.phones': 'æ‰‹æœº',
    'subcat.laptops': 'ç¬”è®°æœ¬',
    'subcat.tablets': 'å¹³æ¿',
    'subcat.cameras': 'ç›¸æœº',
    'subcat.audio': 'éŸ³å“',
    'subcat.gaming': 'æ¸¸æˆè®¾å¤‡',
    'subcat.wearables': 'ç©¿æˆ´è®¾å¤‡',
    'subcat.accessories': 'é…ä»¶',
    // Subcategories - Vehicles
    'subcat.cars': 'æ±½è½¦',
    'subcat.motorcycles': 'æ‘©æ‰˜è½¦',
    'subcat.bicycles': 'è‡ªè¡Œè½¦',
    'subcat.trucks': 'å¡è½¦',
    'subcat.parts': 'é›¶ä»¶',
    // Subcategories - RealEstate
    'subcat.apartments': 'å…¬å¯“',
    'subcat.houses': 'åˆ«å¢…',
    'subcat.land': 'åœŸåœ°',
    'subcat.commercial': 'å•†é“º',
    'subcat.rentals': 'å‡ºç§Ÿ',
    // Subcategories - Furniture
    'subcat.sofas': 'æ²™å‘',
    'subcat.beds': 'åºŠ',
    'subcat.tables': 'æ¡Œæ¤…',
    'subcat.storage': 'å‚¨ç‰©æŸœ',
    'subcat.office': 'åŠå…¬å®¶å…·',
    // Subcategories - Clothing
    'subcat.women': 'å¥³è£…',
    'subcat.men': 'ç”·è£…',
    'subcat.kids': 'ç«¥è£…',
    'subcat.shoes': 'é‹ç±»',
    'subcat.fashion_accessories': 'é…é¥°',
    // Subcategories - Sports
    'subcat.fitness': 'å¥èº«',
    'subcat.outdoor': 'æˆ·å¤–',
    'subcat.team_sports': 'çƒç±»',
    'subcat.water_sports': 'æ°´ä¸Šè¿åŠ¨',
    'subcat.winter_sports': 'å†¬å­£è¿åŠ¨',
    // Subcategories - Services
    'subcat.repair': 'ç»´ä¿®',
    'subcat.cleaning': 'æ¸…æ´',
    'subcat.teaching': 'æ•™å­¦',
    'subcat.beauty': 'ç¾å®¹',
    'subcat.moving': 'æ¬å®¶',
    // Subcategories - Books
    'subcat.fiction': 'å°è¯´',
    'subcat.textbooks': 'æ•™æ',
    'subcat.children': 'å„¿ç«¥è¯»ç‰©',
    'subcat.magazines': 'æ‚å¿—',
    'subcat.comics': 'æ¼«ç”»',
    // Subcategories - Other
    'subcat.collectibles': 'æ”¶è—å“',
    'subcat.pets': 'å® ç‰©ç”¨å“',
    'subcat.food': 'é£Ÿå“',
    'subcat.plants': 'æ¤ç‰©',
    'delivery.meetup': 'å½“é¢äº¤æ˜“',
    'delivery.shipping': 'å¿«é€’å‘è´§',
    'delivery.both': 'é¢äº¤/å¿«é€’',
    'detail.back': 'è¿”å›',
    'detail.seller': 'å–å®¶ä¿¡æ¯',
    'detail.verified': 'å·²è®¤è¯å–å®¶',
    'detail.contact': 'è”ç³»å–å®¶',
    'detail.posted': 'å‘å¸ƒäº',
    'detail.location': 'äº¤æ˜“åœ°ç‚¹',
    'detail.delivery': 'é…é€æ–¹å¼',
    'detail.desc_title': 'å•†å“è¯¦æƒ…',
    'detail.recommend': 'çŒœä½ å–œæ¬¢',
    'detail.report': 'ä¸¾æŠ¥æ­¤å†…å®¹',
    'profile.title': 'ä¸ªäººä¸­å¿ƒ',
    'profile.avatar': 'å¤´åƒ',
    'profile.change_avatar': 'æ›´æ¢å¤´åƒ',
    'profile.name': 'æ˜µç§°',
    'profile.email': 'é‚®ç®±',
    'profile.save': 'ä¿å­˜ä¿®æ”¹',
    'profile.saved': 'ä¿å­˜æˆåŠŸï¼',
    'profile.listings': 'æˆ‘å‘å¸ƒçš„',
    'profile.no_listings': 'æš‚æ— å‘å¸ƒè®°å½•',
    'profile.verify_title': 'èº«ä»½è®¤è¯',
    'profile.verify_desc': 'æäº¤èº«ä»½è¯ä»¶ï¼Œè·å¾—è“ç›¾æ ‡è¯†ï¼Œåšå€¼å¾—ä¿¡èµ–çš„å–å®¶ã€‚',
    'profile.get_verified': 'æäº¤è¯ä»¶ (å…è´¹)',
    'profile.verifying': 'å®¡æ ¸ä¸­...',
    'profile.is_verified': 'èº«ä»½å·²è®¤è¯',
    'profile.boost': 'æ¨å¹¿',
    'profile.safety_policies': 'å®‰å…¨ä¸æ”¿ç­–',
    'profile.content_policy': 'å†…å®¹ä¸æ”¿æ²»è§„èŒƒ',
    'profile.privacy_policy': 'éšç§æ”¿ç­–',
    'profile.buying': 'æˆ‘çš„è®¢å•',
    'profile.selling': 'æˆ‘çš„é”€å”®',
    'profile.payouts': 'æ”¶æ¬¾è®¾ç½®',
    'profile.payouts_desc': 'ç»‘å®šé“¶è¡Œè´¦æˆ·ä»¥æ¥æ”¶é”€å”®æ¬¾é¡¹ (æ”¯æŒStripe)ã€‚',
    'profile.setup_payouts': 'ç«‹å³ç»‘å®š',
    'report.title': 'ä¸¾æŠ¥å†…å®¹',
    'report.reason': 'ä¸¾æŠ¥åŸå› ',
    'report.reason.misinfo': 'æ”¿æ²»è™šå‡ä¿¡æ¯',
    'report.reason.hate': 'ä»‡æ¨è¨€è®ºæˆ–æ­§è§†',
    'report.reason.scam': 'è¯ˆéª—æˆ–è¯¯å¯¼',
    'report.reason.prohibited': 'ç¦æ­¢é”€å”®çš„ç‰©å“',
    'report.reason.sensitive': 'æ•æ„Ÿæ”¿æ²»å®£ä¼ ',
    'report.submit': 'æäº¤ä¸¾æŠ¥',
    'report.success': 'æ„Ÿè°¢æ‚¨çš„åé¦ˆï¼Œæˆ‘ä»¬å°†è¿›è¡Œå®¡æ ¸ã€‚',
    'time.today': 'ä»Šå¤©',
    'time.days_ago': '{0}å¤©å‰',
    'chat.inbox': 'æ¶ˆæ¯åˆ—è¡¨',
    'chat.type': 'è¾“å…¥æ¶ˆæ¯...',
    'chat.send': 'å‘é€',
    'chat.no_msgs': 'æš‚æ— æ¶ˆæ¯',
    'chat.empty_inbox': 'è¿˜æ²¡æœ‰å¼€å§‹ä»»ä½•å¯¹è¯',
    'chat.you': 'ä½ ',
    // è®®ä»·ç›¸å…³
    'nego.title': 'è®®ä»·',
    'nego.original_price': 'åŸä»·',
    'nego.your_offer': 'å‡ºä»·',
    'nego.counter_price': 'å–å®¶æŠ¥ä»·',
    'nego.final_price': 'æˆäº¤ä»·',
    'nego.status.pending': 'å¾…å“åº”',
    'nego.status.accepted': 'å·²æ¥å—',
    'nego.status.rejected': 'å·²æ‹’ç»',
    'nego.status.countered': 'å–å®¶è¿˜ä»·',
    'nego.action.accept': 'æ¥å—',
    'nego.action.counter': 'è¿˜ä»·',
    'nego.action.reject': 'æ‹’ç»',
    'nego.confirm_counter': 'ç¡®è®¤è¿˜ä»·',
    'nego.cancel': 'å–æ¶ˆ',
    'nego.success.accepted': 'è®®ä»·æˆåŠŸï¼ä»·æ ¼',
    'nego.success.rejected': 'å–å®¶æ‹’ç»äº†æ­¤è®®ä»·',
    'nego.success.countered': 'å–å®¶æå‡ºæ–°æŠ¥ä»·',
    'nego.enter_price': 'è¾“å…¥æ‚¨çš„æŠ¥ä»·',
    'nego.failed': 'å“åº”è®®ä»·å¤±è´¥ï¼Œè¯·é‡è¯•',
    // èŠå¤©åˆ—è¡¨
    'chat.tab.all': 'å…¨éƒ¨',
    'chat.tab.active': 'è¿›è¡Œä¸­',
    'chat.tab.inquiring': 'å’¨è¯¢ä¸­',
    'chat.tab.completed': 'å·²å®Œæˆ',
    'chat.unknown_product': 'æœªçŸ¥å•†å“',
    'chat.view_details': 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…',
    'chat.conversations': 'å¯¹è¯',
    'chat.empty_inbox_hint': 'ä»å•†å“é¡µé¢å¼€å§‹èŠå¤©å§',
    'chat.no_chats_in_tab': 'æ­¤åˆ†ç±»æš‚æ— å¯¹è¯',
    'chat.buyers': 'ä½ä¹°å®¶',
    'chat.hide': 'éšè—',
    'chat.delete': 'åˆ é™¤',
    'chat.trading': 'äº¤æ˜“ä¸­',
    'chat.hide_conversation': 'éšè—å¯¹è¯',
    'chat.delete_conversation': 'åˆ é™¤å¯¹è¯',
    'chat.delete_confirm': 'ç¡®å®šåˆ é™¤æ­¤å¯¹è¯ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚',
    'chat.hidden_count': 'ä¸ªå¯¹è¯å·²éšè—',
    'chat.online': 'æ´»è·ƒä¸­',
    'chat.view_product': 'ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…',
    'chat.report_user': 'ä¸¾æŠ¥ç”¨æˆ·',
    'chat.block_user': 'å±è”½ç”¨æˆ·',
    'chat.user_reported': 'å·²ä¸¾æŠ¥',
    'chat.user_blocked': 'å·²å±è”½',
    'chat.loading': 'åŠ è½½ä¸­...',
    'chat.load_earlier': 'åŠ è½½æ›´æ—©çš„æ¶ˆæ¯',
    'chat.send_failed': 'å‘é€å¤±è´¥ï¼Œè¯·é‡è¯•',
    'chat.make_offer': 'è®®ä»·',
    'chat.share_location': 'åˆ†äº«ä½ç½®',
    'chat.arrange_meetup': 'çº¦å®šæ—¶é—´',
    'chat.arrange_meetup_btn': 'å®‰æ’è§é¢',
    'chat.deleted_success': 'èŠå¤©è®°å½•å·²åˆ é™¤',
    'list.search_hint': 'è¯•è¯•æ¢ä¸ªå…³é”®è¯æˆ–æ›´ç¬¼ç»Ÿçš„æœç´¢',
    'list.empty_hint': 'æˆä¸ºè¯¥åˆ†ç±»çš„ç¬¬ä¸€ä¸ªå–å®¶ï¼',
    'product.rate_seller': 'è¯„ä»·å–å®¶',
    'product.share': 'åˆ†äº«',
    'profile.reviews': 'è¯„ä»·',
    'nav.logout': 'é€€å‡ºç™»å½•',
    // Toast æ¶ˆæ¯
    'toast.login_failed': 'ç™»å½•éªŒè¯å¤±è´¥',
    'toast.profile_updated': 'ä¸ªäººèµ„æ–™å·²æ›´æ–°',
    'toast.update_failed': 'æ›´æ–°å¤±è´¥',
    'toast.product_published': 'ğŸ‰ å•†å“å‘å¸ƒæˆåŠŸï¼',
    'toast.product_publish_failed': 'âŒ å•†å“å‘å¸ƒå¤±è´¥',
    'toast.please_login': 'è¯·å…ˆç™»å½•',
    'toast.favorite_added': 'å·²æ·»åŠ åˆ°æ”¶è—',
    'toast.favorite_removed': 'å·²ä»æ”¶è—ç§»é™¤',
    'toast.favorite_update_failed': 'æ”¶è—æ›´æ–°å¤±è´¥',
    'toast.chat_open_failed': 'âŒ æ— æ³•æ‰“å¼€èŠå¤©,è¯·ç¨åé‡è¯•',
    'toast.message_send_failed': 'âŒ æ¶ˆæ¯å‘é€å¤±è´¥,è¯·é‡è¯•',
    'toast.load_failed': 'åŠ è½½å¤±è´¥',
    'toast.upload_failed': 'ä¸Šä¼ å¤±è´¥,è¯·é‡è¯•',
  },
  en: {
    'app.name': 'DESCU',
    'nav.search': 'Search items, cars, homes...',
    'nav.sell': 'Sell',
    'nav.home': 'Home',
    'nav.cart': 'Cart',
    'nav.favorites': 'Favorites',
    'nav.profile': 'Profile',
    'nav.login': 'Login',
    'nav.chat': 'Chat',
    'nav.notifications': 'Alerts',
    'login.required': 'Login Required',
    'login.prompt': 'Please log in to continue',
    'login.google': 'Continue with Google',
    'login.terms': 'By continuing, you agree to our Terms',
    'hero.title': 'Buy Local, Sell in a Flash',
    'hero.subtitle': 'Your AI-powered neighborhood marketplace. Find hidden gems within 5km.',
    'hero.cta': 'Explore Now',
    'list.header': 'Recommended for You',
    'list.search_results': 'Search Results',
    'list.items_count': 'items',
    'list.loading_loc': 'Locating...',
    'list.loc_denied': 'Enable Location',
    'list.loc_success': 'Nearby',
    'list.empty': 'No items yet. Be the first to sell!',
    'list.no_results': 'No items found',
    'list.view_all': 'View All',
    'list.load_more': 'Load More',
    'list.loading_more': 'Loading...',
    'card.nearby': 'Nearby',
    'chat.ask_price': 'Make Offer',
    'chat.offer_title': 'Make an Offer',
    'chat.current_price': 'Current Price',
    'chat.your_offer': 'Your Offer',
    'chat.send_offer': 'Send Offer',
    'chat.cancel': 'Cancel',
    'card.add_cart': 'Add',
    'card.in_cart': 'Added',
    'card.promoted': 'Promoted',
    'modal.title': 'List Item',
    'modal.upload_text': 'Upload Photo',
    'modal.upload_hint': 'AI will auto-fill details',
    'modal.change_img': 'Change Photo',
    'modal.analyzing': 'AI analyzing...',
    'modal.analyzed': 'AI details generated',
    'modal.label.title': 'Title',
    'modal.ph.title': 'e.g., Like new iPhone 14',
    'modal.label.price': 'Price',
    'modal.label.category': 'Category',
    'modal.label.delivery': 'Delivery Method',
    'modal.label.desc': 'Description',
    'modal.ph.desc': 'Describe condition, usage, etc...',
    'modal.loc.loading': 'Locating...',
    'modal.loc.success': 'Location Locked',
    'modal.submit': 'Post Listing',
    'modal.submit.analyzing': 'Analyzing...',
    'modal.policy_hint': 'By posting, you agree to our policies. Hate speech and political misinformation are strictly prohibited.',
    'modal.ai_error': 'AI analysis failed. Please check connection or try again.',
    'cart.title': 'Cart',
    'cart.empty': 'Your cart is empty',
    'cart.go_shop': 'Go Shopping',
    'cart.total': 'Total',
    'cart.checkout': 'Checkout',
    'cart.processing': 'Processing...',
    'cart.success': 'Order Placed!',
    'cat.all': 'All',
    'cat.electronics': 'Electronics',
    'cat.furniture': 'Furniture',
    'cat.clothing': 'Clothing',
    'cat.books': 'Books',
    'cat.sports': 'Sports',
    'cat.vehicles': 'Vehicles',
    'cat.real_estate': 'Real Estate',
    'cat.services': 'Services',
    'cat.other': 'Other',
    // Subcategories - Electronics
    'subcat.phones': 'Phones',
    'subcat.laptops': 'Laptops',
    'subcat.tablets': 'Tablets',
    'subcat.cameras': 'Cameras',
    'subcat.audio': 'Audio',
    'subcat.gaming': 'Gaming',
    'subcat.wearables': 'Wearables',
    'subcat.accessories': 'Accessories',
    // Subcategories - Vehicles
    'subcat.cars': 'Cars',
    'subcat.motorcycles': 'Motorcycles',
    'subcat.bicycles': 'Bicycles',
    'subcat.trucks': 'Trucks',
    'subcat.parts': 'Parts',
    // Subcategories - RealEstate
    'subcat.apartments': 'Apartments',
    'subcat.houses': 'Houses',
    'subcat.land': 'Land',
    'subcat.commercial': 'Commercial',
    'subcat.rentals': 'Rentals',
    // Subcategories - Furniture
    'subcat.sofas': 'Sofas',
    'subcat.beds': 'Beds',
    'subcat.tables': 'Tables & Chairs',
    'subcat.storage': 'Storage',
    'subcat.office': 'Office Furniture',
    // Subcategories - Clothing
    'subcat.women': 'Women',
    'subcat.men': 'Men',
    'subcat.kids': 'Kids',
    'subcat.shoes': 'Shoes',
    'subcat.fashion_accessories': 'Fashion Accessories',
    // Subcategories - Sports
    'subcat.fitness': 'Fitness',
    'subcat.outdoor': 'Outdoor',
    'subcat.team_sports': 'Team Sports',
    'subcat.water_sports': 'Water Sports',
    'subcat.winter_sports': 'Winter Sports',
    // Subcategories - Services
    'subcat.repair': 'Repair',
    'subcat.cleaning': 'Cleaning',
    'subcat.teaching': 'Tutoring',
    'subcat.beauty': 'Beauty',
    'subcat.moving': 'Moving',
    // Subcategories - Books
    'subcat.fiction': 'Fiction',
    'subcat.textbooks': 'Textbooks',
    'subcat.children': 'Children',
    'subcat.magazines': 'Magazines',
    'subcat.comics': 'Comics',
    // Subcategories - Other
    'subcat.collectibles': 'Collectibles',
    'subcat.pets': 'Pet Supplies',
    'subcat.food': 'Food',
    'subcat.plants': 'Plants',
    'delivery.meetup': 'Meetup Only',
    'delivery.shipping': 'Shipping Only',
    'delivery.both': 'Meetup & Shipping',
    'detail.back': 'Back',
    'detail.seller': 'Seller',
    'detail.verified': 'Verified Seller',
    'detail.contact': 'Chat with Seller',
    'detail.posted': 'Posted',
    'detail.location': 'Location',
    'detail.delivery': 'Delivery',
    'detail.desc_title': 'Description',
    'detail.recommend': 'Recommended',
    'detail.report': 'Report this listing',
    'profile.title': 'My Profile',
    'profile.avatar': 'Avatar',
    'profile.change_avatar': 'Change Photo',
    'profile.name': 'Name',
    'profile.email': 'Email',
    'profile.save': 'Save Changes',
    'profile.saved': 'Saved!',
    'profile.listings': 'My Listings',
    'profile.no_listings': 'No active listings',
    'profile.verify_title': 'Identity Verification',
    'profile.verify_desc': 'Upload your ID to become a trusted seller and boost sales.',
    'profile.get_verified': 'Submit ID (Free)',
    'profile.verifying': 'Uploading...',
    'profile.is_verified': 'Identity Verified',
    'profile.boost': 'Boost',
    'profile.safety_policies': 'Safety & Policies',
    'profile.content_policy': 'Content & Political Norms',
    'profile.privacy_policy': 'Privacy Policy',
    'profile.buying': 'My Orders',
    'profile.selling': 'Sales',
    'profile.payouts': 'Payouts & Earnings',
    'profile.payouts_desc': 'Connect your bank account to receive payments directly just like a professional store.',
    'profile.setup_payouts': 'Setup Payouts',
    'report.title': 'Report Content',
    'report.reason': 'Reason for reporting',
    'report.reason.misinfo': 'Political Misinformation',
    'report.reason.hate': 'Hate Speech or Discrimination',
    'report.reason.scam': 'Scam or Misleading',
    'report.reason.prohibited': 'Prohibited Item',
    'report.reason.sensitive': 'Sensitive Political Content',
    'report.submit': 'Submit Report',
    'report.success': 'Thank you for your report. We will review it shortly.',
    'time.today': 'Today',
    'time.days_ago': '{0} days ago',
    'chat.inbox': 'Messages',
    'chat.type': 'Type a message...',
    'chat.send': 'Send',
    'chat.no_msgs': 'No messages yet',
    'chat.empty_inbox': 'No conversations yet',
    'chat.you': 'You',
    // Negotiation
    'nego.title': 'Offer',
    'nego.original_price': 'Original',
    'nego.your_offer': 'Your Offer',
    'nego.counter_price': 'Seller Offer',
    'nego.final_price': 'Final Price',
    'nego.status.pending': 'Pending',
    'nego.status.accepted': 'Accepted',
    'nego.status.rejected': 'Rejected',
    'nego.status.countered': 'Counter Offered',
    'nego.action.accept': 'Accept',
    'nego.action.counter': 'Counter',
    'nego.action.reject': 'Reject',
    'nego.confirm_counter': 'Confirm Counter',
    'nego.cancel': 'Cancel',
    'nego.success.accepted': 'Deal! Price',
    'nego.success.rejected': 'Seller rejected this offer',
    'nego.success.countered': 'Seller made a counter offer',
    'nego.enter_price': 'Enter your price',
    'nego.failed': 'Failed to respond, please retry',
    // Chat tabs
    'chat.tab.all': 'All',
    'chat.tab.active': 'Active',
    'chat.tab.inquiring': 'Inquiring',
    'chat.tab.completed': 'Completed',
    'chat.unknown_product': 'Unknown Product',
    'chat.view_details': 'Click to view details',
    'chat.conversations': 'conversations',
    'chat.empty_inbox_hint': 'Start a conversation from a product page',
    'chat.no_chats_in_tab': 'No conversations in this category',
    'chat.buyers': 'buyers',
    'chat.hide': 'Hide',
    'chat.delete': 'Delete',
    'chat.trading': 'Trading',
    'chat.hide_conversation': 'Hide Chat',
    'chat.delete_conversation': 'Delete Chat',
    'chat.delete_confirm': 'Delete this chat? This cannot be undone.',
    'chat.hidden_count': 'chats hidden',
    'chat.online': 'Online',
    'chat.view_product': 'Tap to view details',
    'chat.report_user': 'Report User',
    'chat.block_user': 'Block User',
    'chat.user_reported': 'User reported',
    'chat.user_blocked': 'User blocked',
    'chat.loading': 'Loading...',
    'chat.load_earlier': 'Load earlier messages',
    'chat.send_failed': 'Send failed, please retry',
    'chat.make_offer': 'Make Offer',
    'chat.share_location': 'Share Location',
    'chat.arrange_meetup': 'Arrange Meetup',
    'chat.arrange_meetup_btn': 'Arrange Meetup',
    'chat.deleted_success': 'Chat deleted',
    'list.search_hint': 'Try different keywords or broader terms',
    'list.empty_hint': 'Be the first to list an item in this category!',
    'product.rate_seller': 'Rate Seller',
    'product.share': 'Share',
    'profile.reviews': 'Reviews',
    'nav.logout': 'Log Out',
    // Toast Messages
    'toast.login_failed': 'Login verification failed',
    'toast.profile_updated': 'Profile updated successfully',
    'toast.update_failed': 'Update failed',
    'toast.product_published': 'ğŸ‰ Product published successfully!',
    'toast.product_publish_failed': 'âŒ Failed to publish product',
    'toast.please_login': 'Please log in first',
    'toast.favorite_added': 'Added to favorites',
    'toast.favorite_removed': 'Removed from favorites',
    'toast.favorite_update_failed': 'Failed to update favorite',
    'toast.chat_open_failed': 'âŒ Unable to open chat, please try again',
    'toast.message_send_failed': 'âŒ Failed to send message, please retry',
    'toast.load_failed': 'Failed to load',
    'toast.upload_failed': 'Upload failed, please try again',
  },
  es: {
    'app.name': 'DESCU',
    'nav.search': 'Buscar autos, depas, servicios...',
    'nav.sell': 'Vender',
    'nav.home': 'Inicio',
    'nav.cart': 'Carrito',
    'nav.favorites': 'Favoritos',
    'nav.profile': 'Perfil',
    'nav.login': 'Entrar',
    'nav.chat': 'Mensajes',
    'nav.notifications': 'Alertas',
    'login.required': 'Iniciar SesiÃ³n',
    'login.prompt': 'Por favor inicia sesiÃ³n para continuar',
    'login.google': 'Continuar con Google',
    'login.terms': 'Al continuar, aceptas nuestros TÃ©rminos',
    'hero.title': 'Compra local, vende rÃ¡pido',
    'hero.subtitle': 'Tu mercado digital inteligente.',
    'hero.cta': 'Ver Ofertas',
    'list.header': 'Recomendados',
    'list.search_results': 'Resultados',
    'list.items_count': 'artÃ­culos',
    'list.loading_loc': 'Ubicando...',
    'list.loc_denied': 'Activar UbicaciÃ³n',
    'list.loc_success': 'Cerca de ti',
    'list.empty': 'Â¡SÃ© el primero en vender algo!',
    'list.no_results': 'No se encontraron resultados',
    'list.view_all': 'Ver Todo',
    'list.load_more': 'Cargar MÃ¡s',
    'list.loading_more': 'Cargando...',
    'card.nearby': 'Cerca',
    'chat.ask_price': 'Ofertar',
    'chat.offer_title': 'Hacer Oferta',
    'chat.current_price': 'Precio Actual',
    'chat.your_offer': 'Tu Oferta',
    'chat.send_offer': 'Enviar Oferta',
    'chat.cancel': 'Cancelar',
    'card.add_cart': 'Lo quiero',
    'card.in_cart': 'Agregado',
    'card.promoted': 'Destacado',
    'modal.title': 'Publicar Anuncio',
    'modal.upload_text': 'Subir Foto',
    'modal.upload_hint': 'La IA llenarÃ¡ los datos por ti',
    'modal.change_img': 'Cambiar Foto',
    'modal.analyzing': 'IA analizando imagen...',
    'modal.analyzed': 'Datos generados por IA',
    'modal.label.title': 'TÃ­tulo',
    'modal.ph.title': 'ej. VW Jetta 2018 impecable',
    'modal.label.price': 'Precio',
    'modal.label.category': 'CategorÃ­a',
    'modal.label.delivery': 'Entrega',
    'modal.label.desc': 'DescripciÃ³n',
    'modal.ph.desc': 'Detalles, condiciones, kilometraje...',
    'modal.loc.loading': 'Localizando...',
    'modal.loc.success': 'UbicaciÃ³n agregada',
    'modal.submit': 'Publicar Ahora',
    'modal.submit.analyzing': 'Analizando...',
    'modal.policy_hint': 'Al publicar, aceptas nuestras polÃ­ticas. Se prohÃ­be el discurso de odio y la desinformaciÃ³n polÃ­tica.',
    'modal.ai_error': 'AnÃ¡lisis de IA fallido. Revisa tu conexiÃ³n o intenta mÃ¡s tarde.',
    'cart.title': 'Carrito',
    'cart.empty': 'Tu carrito estÃ¡ vacÃ­o',
    'cart.go_shop': 'Ir a la tienda',
    'cart.total': 'Total',
    'cart.checkout': 'Comprar',
    'cart.processing': 'Procesando...',
    'cart.success': 'Â¡Compra exitosa!',
    'cat.all': 'Todo',
    'cat.electronics': 'ElectrÃ³nica',
    'cat.furniture': 'Hogar',
    'cat.clothing': 'Moda',
    'cat.books': 'Libros',
    'cat.sports': 'Deportes',
    'cat.vehicles': 'Autos',
    'cat.real_estate': 'Inmuebles',
    'cat.services': 'Servicios',
    'cat.other': 'Otros',
    // Subcategories - Electronics
    'subcat.phones': 'Celulares',
    'subcat.laptops': 'Laptops',
    'subcat.tablets': 'Tablets',
    'subcat.cameras': 'CÃ¡maras',
    'subcat.audio': 'Audio',
    'subcat.gaming': 'Gaming',
    'subcat.wearables': 'Wearables',
    'subcat.accessories': 'Accesorios',
    // Subcategories - Vehicles
    'subcat.cars': 'Autos',
    'subcat.motorcycles': 'Motos',
    'subcat.bicycles': 'Bicicletas',
    'subcat.trucks': 'Camiones',
    'subcat.parts': 'Refacciones',
    // Subcategories - RealEstate
    'subcat.apartments': 'Departamentos',
    'subcat.houses': 'Casas',
    'subcat.land': 'Terrenos',
    'subcat.commercial': 'Locales',
    'subcat.rentals': 'Renta',
    // Subcategories - Furniture
    'subcat.sofas': 'SofÃ¡s',
    'subcat.beds': 'Camas',
    'subcat.tables': 'Mesas y Sillas',
    'subcat.storage': 'Almacenaje',
    'subcat.office': 'Muebles de Oficina',
    // Subcategories - Clothing
    'subcat.women': 'Mujer',
    'subcat.men': 'Hombre',
    'subcat.kids': 'NiÃ±os',
    'subcat.shoes': 'Zapatos',
    'subcat.fashion_accessories': 'Accesorios de Moda',
    // Subcategories - Sports
    'subcat.fitness': 'Fitness',
    'subcat.outdoor': 'Exterior',
    'subcat.team_sports': 'Deportes de Equipo',
    'subcat.water_sports': 'Deportes AcuÃ¡ticos',
    'subcat.winter_sports': 'Deportes de Invierno',
    // Subcategories - Services
    'subcat.repair': 'ReparaciÃ³n',
    'subcat.cleaning': 'Limpieza',
    'subcat.teaching': 'Clases',
    'subcat.beauty': 'Belleza',
    'subcat.moving': 'Mudanzas',
    // Subcategories - Books
    'subcat.fiction': 'FicciÃ³n',
    'subcat.textbooks': 'Libros de Texto',
    'subcat.children': 'Infantil',
    'subcat.magazines': 'Revistas',
    'subcat.comics': 'CÃ³mics',
    // Subcategories - Other
    'subcat.collectibles': 'Coleccionables',
    'subcat.pets': 'Mascotas',
    'subcat.food': 'Comida',
    'subcat.plants': 'Plantas',
    'delivery.meetup': 'Entrega Personal',
    'delivery.shipping': 'EnvÃ­o a Domicilio',
    'delivery.both': 'Entrega Personal o EnvÃ­o',
    'detail.back': 'Volver',
    'detail.seller': 'Vendedor',
    'detail.verified': 'Vendedor Verificado',
    'detail.contact': 'Contactar Vendedor',
    'detail.posted': 'Publicado',
    'detail.location': 'UbicaciÃ³n',
    'detail.delivery': 'Entrega',
    'detail.desc_title': 'DescripciÃ³n',
    'detail.recommend': 'Te puede interesar',
    'detail.report': 'Reportar este anuncio',
    'profile.title': 'Mi Perfil',
    'profile.avatar': 'Foto de Perfil',
    'profile.change_avatar': 'Cambiar Foto',
    'profile.name': 'Nombre',
    'profile.email': 'Correo',
    'profile.save': 'Guardar Cambios',
    'profile.saved': 'Â¡Guardado!',
    'profile.listings': 'Mis Publicaciones',
    'profile.no_listings': 'Sin publicaciones activas',
    'profile.verify_title': 'VerificaciÃ³n de Identidad',
    'profile.verify_desc': 'Sube tu identificaciÃ³n oficial (INE/Pasaporte) para ser un vendedor confiable.',
    'profile.get_verified': 'Subir ID (Gratis)',
    'profile.verifying': 'Subiendo...',
    'profile.is_verified': 'Identidad Verificada',
    'profile.boost': 'Destacar',
    'profile.safety_policies': 'Seguridad y PolÃ­ticas',
    'profile.content_policy': 'Normas de Contenido y PolÃ­tica',
    'profile.privacy_policy': 'PolÃ­tica de Privacidad',
    'profile.buying': 'Mis Compras',
    'profile.selling': 'Mis Ventas',
    'profile.payouts': 'Pagos y Ganancias',
    'profile.payouts_desc': 'Conecta tu cuenta bancaria para recibir pagos directamente como una tienda profesional.',
    'profile.setup_payouts': 'Configurar Pagos',
    'report.title': 'Reportar Contenido',
    'report.reason': 'Motivo del reporte',
    'report.reason.misinfo': 'DesinformaciÃ³n PolÃ­tica',
    'report.reason.hate': 'Discurso de Odio o DiscriminaciÃ³n',
    'report.reason.scam': 'Fraude o EngaÃ±o',
    'report.reason.prohibited': 'ArtÃ­culo Prohibido',
    'report.reason.sensitive': 'Contenido PolÃ­tico Sensible',
    'report.submit': 'Enviar Reporte',
    'report.success': 'Gracias por tu reporte. Lo revisaremos a la brevedad.',
    'time.today': 'Hoy',
    'time.days_ago': 'Hace {0} dÃ­as',
    'chat.inbox': 'Mensajes',
    'chat.type': 'Escribe un mensaje...',
    'chat.send': 'Enviar',
    'chat.no_msgs': 'AÃºn no hay mensajes',
    'chat.empty_inbox': 'No tienes conversaciones',
    'chat.you': 'TÃº',
    // NegociaciÃ³n
    'nego.title': 'Oferta',
    'nego.original_price': 'Precio Original',
    'nego.your_offer': 'Tu Oferta',
    'nego.counter_price': 'Contraoferta',
    'nego.final_price': 'Precio Final',
    'nego.status.pending': 'Pendiente',
    'nego.status.accepted': 'Aceptada',
    'nego.status.rejected': 'Rechazada',
    'nego.status.countered': 'Contraoferta',
    'nego.action.accept': 'Aceptar',
    'nego.action.counter': 'Contraofertar',
    'nego.action.reject': 'Rechazar',
    'nego.confirm_counter': 'Confirmar',
    'nego.cancel': 'Cancelar',
    'nego.success.accepted': 'Â¡Trato hecho! Precio',
    'nego.success.rejected': 'El vendedor rechazÃ³ esta oferta',
    'nego.success.countered': 'El vendedor hizo una contraoferta',
    'nego.enter_price': 'Ingresa tu precio',
    'nego.failed': 'Error al responder, intenta de nuevo',
    // PestaÃ±as de chat
    'chat.tab.all': 'Todo',
    'chat.tab.active': 'Activo',
    'chat.tab.inquiring': 'Consultando',
    'chat.tab.completed': 'Completado',
    'chat.unknown_product': 'Producto desconocido',
    'chat.view_details': 'Clic para ver detalles',
    'chat.conversations': 'conversaciones',
    'chat.empty_inbox_hint': 'Inicia una conversaciÃ³n desde un producto',
    'chat.no_chats_in_tab': 'No hay conversaciones en esta categorÃ­a',
    'chat.buyers': 'compradores',
    'chat.hide': 'Ocultar',
    'chat.delete': 'Eliminar',
    'chat.trading': 'En proceso',
    'chat.hide_conversation': 'Ocultar chat',
    'chat.delete_conversation': 'Eliminar chat',
    'chat.delete_confirm': 'Â¿Eliminar este chat? Esta acciÃ³n no se puede deshacer.',
    'chat.hidden_count': 'chats ocultos',
    'chat.online': 'En lÃ­nea',
    'chat.view_product': 'Toca para ver detalles',
    'chat.report_user': 'Reportar Usuario',
    'chat.block_user': 'Bloquear Usuario',
    'chat.user_reported': 'Usuario reportado',
    'chat.user_blocked': 'Usuario bloqueado',
    'chat.loading': 'Cargando...',
    'chat.load_earlier': 'Cargar mensajes anteriores',
    'chat.send_failed': 'EnvÃ­o fallido, intenta de nuevo',
    'chat.make_offer': 'Ofertar',
    'chat.share_location': 'Compartir UbicaciÃ³n',
    'chat.arrange_meetup': 'Agendar Encuentro',
    'chat.arrange_meetup_btn': 'Agendar Encuentro',
    'chat.deleted_success': 'Chat eliminado',
    'list.search_hint': 'Intenta con otras palabras o tÃ©rminos mÃ¡s amplios',
    'list.empty_hint': 'Â¡SÃ© el primero en publicar en esta categorÃ­a!',
    'product.rate_seller': 'Calificar Vendedor',
    'product.share': 'Compartir',
    'profile.reviews': 'ReseÃ±as',
    'nav.logout': 'Cerrar SesiÃ³n',
    // Mensajes Toast
    'toast.login_failed': 'Error de verificaciÃ³n de inicio de sesiÃ³n',
    'toast.profile_updated': 'Perfil actualizado exitosamente',
    'toast.update_failed': 'ActualizaciÃ³n fallida',
    'toast.product_published': 'ğŸ‰ Â¡Producto publicado con Ã©xito!',
    'toast.product_publish_failed': 'âŒ Error al publicar producto',
    'toast.please_login': 'Por favor inicia sesiÃ³n primero',
    'toast.favorite_added': 'Agregado a favoritos',
    'toast.favorite_removed': 'Eliminado de favoritos',
    'toast.favorite_update_failed': 'Error al actualizar favorito',
    'toast.chat_open_failed': 'âŒ No se puede abrir el chat, intenta mÃ¡s tarde',
    'toast.message_send_failed': 'âŒ Error al enviar mensaje, intenta de nuevo',
    'toast.load_failed': 'Error al cargar',
    'toast.upload_failed': 'Error al subir, intenta de nuevo',
  }
};

export const LanguageProvider: React.FC<{ children: ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>(() => {
    // 1. Check local storage
    const saved = localStorage.getItem('app_language') as Language;
    if (saved && ['zh', 'en', 'es'].includes(saved)) return saved;

    // 2. Check browser language
    if (typeof navigator !== 'undefined') {
      const browserLang = navigator.language.toLowerCase();
      if (browserLang.startsWith('zh')) return 'zh';
      if (browserLang.startsWith('en')) return 'en';
      if (browserLang.startsWith('es')) return 'es';
    }

    // 3. Default
    return 'es';
  });

  useEffect(() => {
    localStorage.setItem('app_language', language);
  }, [language]);

  const t = (key: string): string => {
    return translations[language][key] || key;
  };

  const formatPrice = (price: number) => {
    if (language === 'zh') {
      return `Â¥${price.toLocaleString()}`;
    } else {
      return `$${price.toLocaleString()}`;
    }
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t, formatPrice }}>
      {children}
    </LanguageContext.Provider>
  );
};

export const useLanguage = () => {
  const context = useContext(LanguageContext);
  if (!context) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
};
